import{r as o,h as j,v as S,A as _,t as I,j as t,a as w,N as y,B as D,R}from"./main-01589982.js";import{a as T,v as W,D as G}from"./useQuery-2326dd90.js";import{C as A}from"./CircleLoading-5a5ec4b1.js";function V(c,i){var m=T(i==null?void 0:i.client);W(c,G.Mutation);var p=o.useState({called:!1,loading:!1,client:m}),l=p[0],v=p[1],e=o.useRef({result:l,mutationId:0,isMounted:!0,client:m,mutation:c,options:i});Object.assign(e.current,{client:m,options:i,mutation:c});var b=o.useCallback(function(s){s===void 0&&(s={});var k=e.current,x=k.client,C=k.options,M=k.mutation,L=j(j({},C),{mutation:M});!e.current.result.loading&&!L.ignoreResults&&e.current.isMounted&&v(e.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:x});var h=++e.current.mutationId,u=S(L,s);return x.mutate(u).then(function(r){var n,d,a,g=r.data,f=r.errors,U=f&&f.length>0?new _({graphQLErrors:f}):void 0;if(h===e.current.mutationId&&!u.ignoreResults){var E={called:!0,loading:!1,data:g,error:U,client:x};e.current.isMounted&&!I(e.current.result,E)&&v(e.current.result=E)}return(d=(n=e.current.options)===null||n===void 0?void 0:n.onCompleted)===null||d===void 0||d.call(n,r.data,u),(a=s.onCompleted)===null||a===void 0||a.call(s,r.data,u),r}).catch(function(r){var n,d,a,g;if(h===e.current.mutationId&&e.current.isMounted){var f={loading:!1,error:r,data:void 0,called:!0,client:x};I(e.current.result,f)||v(e.current.result=f)}if(!((n=e.current.options)===null||n===void 0)&&n.onError||u.onError)return(a=(d=e.current.options)===null||d===void 0?void 0:d.onError)===null||a===void 0||a.call(d,r,u),(g=s.onError)===null||g===void 0||g.call(s,r,u),{data:void 0,errors:r};throw r})},[]),N=o.useCallback(function(){e.current.isMounted&&v({called:!1,loading:!1,client:m})},[]);return o.useEffect(function(){return e.current.isMounted=!0,function(){e.current.isMounted=!1}},[]),[b,j({reset:N},l)]}const B=({className:c="block",children:i})=>t("span",{className:`nc-Label ${c} text-neutral-800 font-medium text-sm dark:text-neutral-300`,"data-nc-id":"Label",children:i}),F=({className:c="flex-1",contentClassName:i="px-6 pt-5 pb-6 ",onChangeImage:m=()=>{},defaultImage:p={sourceUrl:"",id:""}})=>{const[l,v]=o.useState(p),[e,b]=o.useState(!1),[N,s]=o.useState(""),k=o.useId()+"_fileUpload",x=o.useDeferredValue(l.id);o.useEffect(()=>{v(p)},[p.id]),o.useEffect(()=>{m(l)},[x]);const C=async r=>{v({sourceUrl:"",id:"",altText:""})};function M(r){return/(\.jpg|\.jpeg|\.png|\.gif|\.ico|\.webp|\.JPG|\.JPEG|\.PNG|\.GIF)$/i.exec(r)}const L=r=>{if(s(""),r.target.files&&r.target.files[0]){b(!0);const n=r.target.files[0];if(!M(n.name)){s(`${y["File type is not allowed"]}. ${y["Only image files are permitted"]}.`),b(!1);return}const d=new FormData;d.append("file",n),jQuery.ajax({url:window.frontendObject.restVarsEndpoint,method:"POST",processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.frontendObject.restVarsNonce)},data:d}).done(function(a){v({sourceUrl:a.source_url,id:a.id,altText:a.alt_text})}).fail(function(a){var f;const g=((f=a.responseJSON)==null?void 0:f.message)||y.somethingWentWrong;s(g)}).always(function(){b(!1)})}},h=e,u=N;return w("div",{className:c,children:[t("label",{htmlFor:k,className:`block group ${h?"cursor-not-allowed animate-pulse":"cursor-pointer"}`,children:w("div",{className:`relative mt-1 flex justify-center border-2 border-neutral-300 dark:border-neutral-6000 border-dashed rounded-xl ${i}`,children:[!!l.sourceUrl&&!h&&t("div",{className:`opacity-0 group-hover:opacity-100 absolute right-2.5 top-2.5 z-10 p-1.5 bg-neutral-900 dark:bg-neutral-700 text-white rounded-md cursor-pointer \r
              transition-opacity duration-300 `,title:"Delete image",onClick:r=>{r.preventDefault(),C(String(l.id))},children:w("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[t("path",{d:"M21 5.97998C17.67 5.64998 14.32 5.47998 10.98 5.47998C9 5.47998 7.02 5.57998 5.04 5.77998L3 5.97998",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M8.5 4.97L8.72 3.66C8.88 2.71 9 2 10.69 2H13.31C15 2 15.13 2.75 15.28 3.67L15.5 4.97",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M18.85 9.14001L18.2 19.21C18.09 20.78 18 22 15.21 22H8.79002C6.00002 22 5.91002 20.78 5.80002 19.21L5.15002 9.14001",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M10.33 16.5H13.66",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M9.5 12.5H14.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),w("div",{className:"flex-1 space-y-1 text-center",children:[l.sourceUrl&&t("div",{className:"w-full max-w-md mx-auto",children:t("div",{className:"w-full aspect-w-16 aspect-h-8",children:t("img",{src:l.sourceUrl,className:"rounded-lg object-cover shadow-lg",alt:""})})}),!l.sourceUrl&&t("svg",{className:"mx-auto h-12 w-12 text-neutral-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:t("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),t("div",{className:"flex justify-center text-sm text-neutral-6000 dark:text-neutral-300",children:w("label",{className:"relative flex-shrink-0 cursor-pointer  rounded-md font-medium text-primary-6000 dark:text-primary-400 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500",children:[h?t(A,{className:"ml-3 text-blue-600 ",childClassName:"w-5 h-5"}):t("span",{children:l.sourceUrl?y["Click to change"]:y["Upload a file"]}),t("input",{disabled:h,id:k,name:"fileUpload",type:"file",className:"sr-only",onChange:L})]})}),t("p",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:"PNG, JPG, GIF, WEBP, SVG ..."})]})]})}),u&&t(D,{containerClassName:"text-sm mt-4",type:"error",children:u})]})},O=R.forwardRef(({className:c="",children:i,...m},p)=>t("textarea",{ref:p,className:`block w-full text-sm rounded-xl border-neutral-200 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 bg-white dark:border-neutral-700 dark:focus:ring-primary-6000 dark:focus:ring-opacity-25 dark:bg-neutral-900 ${c}`,rows:4,...m,children:i}));export{F as I,B as L,O as T,V as u};
